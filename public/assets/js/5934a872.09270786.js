"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[82468],{62466:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"web-app/features/hive-management","title":"Hive Management - Technical Documentation","description":"\ud83c\udfaf Overview","source":"@site/docs/web-app/features/hive-management.md","sourceDirName":"web-app/features","slug":"/web-app/features/hive-management","permalink":"/docs/web-app/features/hive-management","draft":false,"unlisted":false,"editUrl":"https://github.com/gratheon/website/tree/main/packages/create-docusaurus/templates/shared/docs/web-app/features/hive-management.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Frame Side Management - Technical Documentation","permalink":"/docs/web-app/features/frame-side-management"},"next":{"title":"User Registration - Technical Documentation","permalink":"/docs/web-app/features/user-registration"}}');var s=i(74848),a=i(28453);const r={sidebar_position:9},l="Hive Management - Technical Documentation",o={},c=[{value:"\ud83c\udfaf Overview",id:"-overview",level:3},{value:"\ud83c\udfd7\ufe0f Architecture",id:"\ufe0f-architecture",level:3},{value:"Components",id:"components",level:4},{value:"Services",id:"services",level:4},{value:"\ud83d\udccb Technical Specifications",id:"-technical-specifications",level:3},{value:"Database Schema",id:"database-schema",level:4},{value:"GraphQL API",id:"graphql-api",level:4},{value:"\ud83d\udd27 Implementation Details",id:"-implementation-details",level:3},{value:"Frontend (web-app)",id:"frontend-web-app",level:4},{value:"Backend (swarm-api)",id:"backend-swarm-api",level:4},{value:"Key Operations",id:"key-operations",level:4},{value:"Data Flow",id:"data-flow",level:4},{value:"\u2699\ufe0f Configuration",id:"\ufe0f-configuration",level:3},{value:"\ud83e\uddea Testing",id:"-testing",level:3},{value:"Unit Tests",id:"unit-tests",level:4},{value:"Integration Tests",id:"integration-tests",level:4},{value:"E2E Tests",id:"e2e-tests",level:4},{value:"\ud83d\udcca Performance Considerations",id:"-performance-considerations",level:3},{value:"Optimizations",id:"optimizations",level:4},{value:"Metrics",id:"metrics",level:4},{value:"Bottlenecks",id:"bottlenecks",level:4},{value:"\ud83d\udeab Technical Limitations",id:"-technical-limitations",level:3},{value:"\ud83d\udd17 Related Documentation",id:"-related-documentation",level:3},{value:"\ud83d\udcda Development Resources",id:"-development-resources",level:3},{value:"\ud83d\udcac Technical Notes",id:"-technical-notes",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"hive-management---technical-documentation",children:"Hive Management - Technical Documentation"})}),"\n",(0,s.jsx)(n.h3,{id:"-overview",children:"\ud83c\udfaf Overview"}),"\n",(0,s.jsx)(n.p,{children:"Core beehive CRUD operations with hierarchical structure management, status tracking, device integration, and colony lineage support. Enables beekeepers to create and organize individual hive records with equipment tracking and sensor associations."}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-architecture",children:"\ud83c\udfd7\ufe0f Architecture"}),"\n",(0,s.jsx)(n.h4,{id:"components",children:"Components"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HiveList"}),": React component displaying all hives in an apiary"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HiveCard"}),": Individual hive visualization with color, name, status"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HiveEditor"}),": Form component for creating/editing hive details"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HiveStatusBadge"}),": Visual indicator for hive health status"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DeviceAssociationPanel"}),": UI for linking sensors and cameras"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"services",children:"Services"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"swarm-api"}),": Primary service handling hive CRUD operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"gate-video-stream"}),": Integrates for entrance observer cameras"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"beehive-sensors"}),": Links temperature/humidity sensors"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"graphql-router"}),": Federated gateway routing hive queries"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-technical-specifications",children:"\ud83d\udccb Technical Specifications"}),"\n",(0,s.jsx)(n.h4,{id:"database-schema",children:"Database Schema"}),"\n",(0,s.jsx)(n.mermaid,{value:'erDiagram\n    apiaries ||--o{ hives : "contains"\n    hives ||--o{ boxes : "has"\n    hives ||--o| families : "has_queen"\n    hives ||--o{ hives : "parent_child"\n    hives ||--o{ devices : "connected_to"\n    \n    apiaries {\n        int id PK\n        int user_id FK\n        varchar name\n        varchar lat\n        varchar lng\n    }\n    \n    hives {\n        int id PK\n        int user_id FK\n        int apiary_id FK\n        varchar name\n        varchar color_hex "visual identification"\n        text notes\n        enum status "active, queenless, weak, preparing_swarm, collapsed"\n        timestamp added\n        tinyint active "soft delete flag"\n        datetime collapse_date\n        varchar collapse_cause\n        int parent_hive_id FK "for split tracking"\n        datetime split_date\n        int family_id FK "queen information"\n    }\n    \n    boxes {\n        int id PK\n        int hive_id FK\n        int position "bottom to top ordering"\n        enum type "brood, honey, super"\n        int frame_count\n    }\n    \n    families {\n        int id PK\n        varchar race\n        varchar added "year marked"\n    }\n    \n    devices {\n        int id PK\n        int hive_id FK\n        enum type "entrance_observer, scale, temp_sensor, camera"\n        varchar device_id\n        boolean active\n    }'}),"\n",(0,s.jsx)(n.h4,{id:"graphql-api",children:"GraphQL API"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:"type Hive {\n  id: ID!\n  name: String!\n  color: String\n  status: HiveStatus!\n  notes: String\n  apiary: Apiary!\n  boxes: [Box!]!\n  family: Family\n  devices: [Device!]\n  parentHive: Hive\n  childHives: [Hive!]\n  collapseDate: DateTime\n  collapseCause: String\n  splitDate: DateTime\n  added: DateTime!\n  active: Boolean!\n}\n\nenum HiveStatus {\n  ACTIVE\n  QUEENLESS\n  WEAK\n  PREPARING_SWARM\n  COLLAPSED\n}\n\ntype Box {\n  id: ID!\n  position: Int!\n  type: BoxType!\n  frameCount: Int!\n  frames: [Frame!]\n}\n\nenum BoxType {\n  BROOD\n  HONEY\n  SUPER\n}\n\ntype Device {\n  id: ID!\n  type: DeviceType!\n  deviceId: String!\n  active: Boolean!\n}\n\nenum DeviceType {\n  ENTRANCE_OBSERVER\n  SCALE\n  TEMP_SENSOR\n  CAMERA\n}\n\ninput HiveInput {\n  apiaryId: ID!\n  name: String!\n  color: String\n  notes: String\n  boxCount: Int!\n  framesPerBox: Int!\n}\n\ninput UpdateHiveInput {\n  id: ID!\n  name: String\n  color: String\n  notes: String\n  status: HiveStatus\n}\n\ntype Query {\n  hive(id: ID!): Hive!\n  hives(apiaryId: ID!): [Hive!]!\n  hivesByStatus(status: HiveStatus!): [Hive!]!\n}\n\ntype Mutation {\n  addHive(input: HiveInput!): Hive!\n  updateHive(input: UpdateHiveInput!): Hive!\n  deleteHive(id: ID!): Boolean!\n  setHiveStatus(hiveId: ID!, status: HiveStatus!): Hive!\n  linkDevice(hiveId: ID!, deviceType: DeviceType!, deviceId: String!): Device!\n  unlinkDevice(deviceId: ID!): Boolean!\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-implementation-details",children:"\ud83d\udd27 Implementation Details"}),"\n",(0,s.jsx)(n.h4,{id:"frontend-web-app",children:"Frontend (web-app)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Framework"}),": React with TypeScript"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State Management"}),": Apollo Client cache"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Color Picker"}),": React color picker for hive identification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Status Selection"}),": Dropdown with icon indicators"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Drag-and-Drop"}),": For reordering hives within apiary (future)"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"backend-swarm-api",children:"Backend (swarm-api)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Language"}),": Go"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"}),": MySQL with foreign key constraints"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transactions"}),": Atomic hive + boxes + frames creation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Soft Deletes"}),": active flag prevents data loss"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cascade Rules"}),": ON DELETE CASCADE for boxes/frames"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"key-operations",children:"Key Operations"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Create Hive"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func (r *mutationResolver) AddHive(ctx context.Context, input HiveInput) (*Hive, error) {\n    tx := r.DB.Begin()\n    \n    // Create hive record\n    hive := &Hive{\n        UserID: userID,\n        ApiaryID: input.ApiaryId,\n        Name: input.Name,\n        Color: input.Color,\n        Status: "active",\n    }\n    tx.Create(hive)\n    \n    // Create initial boxes and frames\n    for i := 0; i < input.BoxCount; i++ {\n        box := &Box{\n            HiveID: hive.ID,\n            Position: i,\n            Type: "brood",\n            FrameCount: input.FramesPerBox,\n        }\n        tx.Create(box)\n        \n        // Create frames for this box\n        for j := 0; j < input.FramesPerBox; j++ {\n            frame := &Frame{\n                BoxID: box.ID,\n                Position: j,\n            }\n            tx.Create(frame)\n        }\n    }\n    \n    tx.Commit()\n    return hive, nil\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"data-flow",children:"Data Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TB\n    A[User creates hive] --\x3e B[Send addHive mutation]\n    B --\x3e C[swarm-api validates input]\n    C --\x3e D[Begin transaction]\n    D --\x3e E[Insert hive record]\n    E --\x3e F[Create boxes]\n    F --\x3e G[Create frames for each box]\n    G --\x3e H[Commit transaction]\n    H --\x3e I[Publish Redis event]\n    I --\x3e J[Update Apollo cache]\n    J --\x3e K[Render hive card]\n    \n    L[User links device] --\x3e M[linkDevice mutation]\n    M --\x3e N[Validate device exists]\n    N --\x3e O[Create device association]\n    O --\x3e P[Return device]"}),"\n",(0,s.jsx)(n.h3,{id:"\ufe0f-configuration",children:"\u2699\ufe0f Configuration"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Environment Variables (swarm-api)"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"MYSQL_HOST=localhost\nMYSQL_PORT=3306\nMYSQL_DATABASE=swarm\nMYSQL_USER=swarm_api\nMYSQL_PASSWORD=<secret>\n\nJWT_SECRET=<secret>\n\nREDIS_HOST=localhost:6379\nREDIS_PASSWORD=<secret>\n\nDEFAULT_BOX_COUNT=2\nDEFAULT_FRAMES_PER_BOX=10\nMAX_BOXES_PER_HIVE=10\nMAX_FRAMES_PER_BOX=12\n"})}),"\n",(0,s.jsx)(n.h3,{id:"-testing",children:"\ud83e\uddea Testing"}),"\n",(0,s.jsx)(n.h4,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Hive CRUD operations"}),"\n",(0,s.jsx)(n.li,{children:"Status transitions validation"}),"\n",(0,s.jsx)(n.li,{children:"Color hex validation"}),"\n",(0,s.jsx)(n.li,{children:"Device linking logic"}),"\n",(0,s.jsx)(n.li,{children:"Soft delete behavior"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Full hive creation with boxes and frames"}),"\n",(0,s.jsx)(n.li,{children:"Hive update preserves relationships"}),"\n",(0,s.jsx)(n.li,{children:"Hive deletion cascades to boxes/frames"}),"\n",(0,s.jsx)(n.li,{children:"Device association and unlinking"}),"\n",(0,s.jsx)(n.li,{children:"Parent-child hive relationships"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"e2e-tests",children:"E2E Tests"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"User creates hive with 2 boxes, 10 frames each"}),"\n",(0,s.jsx)(n.li,{children:"User edits hive name and color"}),"\n",(0,s.jsx)(n.li,{children:"User changes hive status to queenless"}),"\n",(0,s.jsx)(n.li,{children:"User links entrance observer device"}),"\n",(0,s.jsx)(n.li,{children:"User deletes hive (soft delete)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-performance-considerations",children:"\ud83d\udcca Performance Considerations"}),"\n",(0,s.jsx)(n.h4,{id:"optimizations",children:"Optimizations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Database indexes on user_id, apiary_id, active"}),"\n",(0,s.jsx)(n.li,{children:"Transaction batching for hive + boxes + frames creation"}),"\n",(0,s.jsx)(n.li,{children:"Redis caching for frequently accessed hives"}),"\n",(0,s.jsx)(n.li,{children:"Pagination for large apiary hive lists"}),"\n",(0,s.jsx)(n.li,{children:"Lazy loading of boxes and frames"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"metrics",children:"Metrics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Hive creation: under 300ms (with 2 boxes, 20 frames)"}),"\n",(0,s.jsx)(n.li,{children:"Hive update: under 100ms"}),"\n",(0,s.jsx)(n.li,{children:"Hive deletion (soft): under 50ms"}),"\n",(0,s.jsx)(n.li,{children:"Hive list query: under 200ms (with 50 hives)"}),"\n",(0,s.jsx)(n.li,{children:"Device linking: under 100ms"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"bottlenecks",children:"Bottlenecks"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creating hives with many boxes (over 5) and frames (over 50 total)"}),"\n",(0,s.jsx)(n.li,{children:"Querying hive list with full box/frame data (use pagination)"}),"\n",(0,s.jsx)(n.li,{children:"Real-time updates for many concurrent users"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-technical-limitations",children:"\ud83d\udeab Technical Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Maximum 10 boxes per hive (configurable)"}),"\n",(0,s.jsx)(n.li,{children:"Maximum 12 frames per box (standard Langstroth)"}),"\n",(0,s.jsx)(n.li,{children:"Color must be valid hex code (#RRGGBB)"}),"\n",(0,s.jsx)(n.li,{children:"Cannot restore hard-deleted hives"}),"\n",(0,s.jsx)(n.li,{children:"Device must exist before linking (no auto-creation)"}),"\n",(0,s.jsx)(n.li,{children:"Parent-child relationships don't track merge operations (only splits)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-related-documentation",children:"\ud83d\udd17 Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/web-app/features/apiary-management",children:"Apiary Management Technical Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/web-app/features/split-colony",children:"Split Colony Technical Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/web-app/features/join-colonies",children:"Join Colonies Technical Documentation"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-development-resources",children:"\ud83d\udcda Development Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/Gratheon/swarm-api",children:"swarm-api repository"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/Gratheon/graphql-schema-registry",children:"GraphQL schema"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/Gratheon/web-app/src/components/HiveCard",children:"Hive management UI"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-technical-notes",children:"\ud83d\udcac Technical Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Consider adding GPS coordinates at hive level (currently only at apiary level)"}),"\n",(0,s.jsx)(n.li,{children:"Status transitions could be automated based on queen detection results"}),"\n",(0,s.jsx)(n.li,{children:"Color picker could suggest colors based on beekeeping year marking convention"}),"\n",(0,s.jsx)(n.li,{children:'May want to add "notes" timeline to track inspection observations over time'}),"\n",(0,s.jsx)(n.li,{children:"Device linking could benefit from QR code scanning for easier setup"}),"\n",(0,s.jsx)(n.li,{children:"Consider adding hive templates for common configurations (8-frame, 10-frame, top-bar)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Last Updated"}),": December 5, 2025\n",(0,s.jsx)(n.strong,{children:"Maintained By"}),": Backend Team"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(96540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);